import{r as T,_ as V}from"./index-b1222951.js";import{S as x}from"./axios-8b100baf.js";import{a as E}from"./articlelist-107b1e57.js";import{_ as G}from"./index.vue_vue_type_script_setup_true_lang-cf697dbf.js";import{d as W,r as h,f as A,t as $,a0 as w,c as t,u as L,X as o,F as b,Y as s,Z as c,a1 as O,I as C,a2 as X,a3 as Y,_ as Z,W as j,$ as z}from"./@vue-ed0e62b5.js";import{n as _}from"./ant-design-vue-ff946531.js";import"./pinia-ae91085a.js";import"./vue-router-1948c3ab.js";import"./@ant-design-4a0ad1b8.js";import"./@ctrl-fb5a5473.js";import"./@babel-9393a256.js";import"./resize-observer-polyfill-3d106987.js";import"./@emotion-c0b5c018.js";import"./stylis-af24efd6.js";import"./scroll-into-view-if-needed-6b992d05.js";import"./compute-scroll-into-view-183f845a.js";import"./vue-types-ef06c517.js";import"./dom-align-529d0cdc.js";import"./lodash-es-46efcfe4.js";import"./dayjs-bea8cda3.js";import"./async-validator-dee29e8b.js";import"./throttle-debounce-87e7e444.js";import"./axios-4a70c6fc.js";import"./request-b9cb8a26.js";import"./@tinymce-0701f23f.js";import"./tinymce-a1c110f5.js";const H=d=>(X("data-v-dd2679f0"),d=d(),Y(),d),J=H(()=>Z("br",null,null,-1)),K=W({__name:"CA_ArticleAdd",setup(d){let m;x.get("/api/v1/AuthTokenInfo/"+window.sessionStorage.getItem("token")).then(l=>{m=l.data.UserInfo[0].ID});const f=h(),e=A({uid:m,title:"",desc:"",tags:void 0,cid:1,img:"",content:""}),p=h([]),g=A({list:[{id:null,name:"不使用分类"}]}),I=()=>{x.get("api/v1/category",{params:{page_num:1}}).then(l=>{if(l.data.total!=0){let a=[];for(let i=0;i<l.data.total;i++)a.push({id:l.data.data[i].id,name:l.data.data[i].name});g.list=a}})},S={title:[{required:!0,message:"请输入文章标题",trigger:"change"}],desc:[{required:!0,message:"请输入文章概要",trigger:"change"}],content:[{required:!0,message:"请输入文章内容",trigger:"change"}]},k=l=>{e.content=l},F=()=>{e.uid=m,e.tags=p.value.toString(),E.articleAddApi(e).then(l=>{l.data.status!=200?_.error({message:"Error",description:l.data.message}):(_.success({message:"Success",description:"文章发表成功"}),f.value.resetFields())})},U=()=>{_.warn({message:"Warn",description:"请勿提交非法数据！"}),console.log(e.content)};return I(),$(e),(l,a)=>{const i=s("a-page-header"),v=s("a-input"),r=s("a-form-item"),B=s("a-textarea"),y=s("a-col"),u=s("a-select"),D=s("a-row"),R=s("a-button"),q=s("a-form"),N=s("a-card");return c(),w(b,null,[t(i,{style:{border:"1px solid rgb(235, 237, 240)"},title:"撰写文章",onBack:a[0]||(a[0]=()=>L(T).push("Index"))}),J,t(N,null,{default:o(()=>[t(q,{ref_key:"formRef",ref:f,model:e,rules:S,name:"ArticleAddForm",onFinish:F,onFinishFailed:U},{default:o(()=>[t(D,null,{default:o(()=>[t(y,{span:12},{default:o(()=>[t(r,{label:"文章标题",name:"title",style:{width:"550px"}},{default:o(()=>[t(v,{value:e.title,"onUpdate:value":a[1]||(a[1]=n=>e.title=n)},null,8,["value"])]),_:1}),t(r,{label:"文章概要",name:"desc",style:{width:"550px"}},{default:o(()=>[t(B,{value:e.desc,"onUpdate:value":a[2]||(a[2]=n=>e.desc=n),style:{height:"85px"}},null,8,["value"])]),_:1})]),_:1}),t(y,{span:12},{default:o(()=>[t(r,{label:"文章标签",name:"tags",style:{width:"550px"}},{default:o(()=>[t(u,{value:p.value,"onUpdate:value":a[3]||(a[3]=n=>p.value=n),"token-separators":[","],mode:"tags",placeholder:"填写一些文章的标签",style:{width:"100%"}},null,8,["value"])]),_:1}),t(r,{label:"文章分类",name:"cid",style:{width:"550px"}},{default:o(()=>[t(u,{value:e.cid,"onUpdate:value":a[4]||(a[4]=n=>e.cid=n),name:"cid",placeholder:"文章分类"},{default:o(()=>[(c(!0),w(b,null,O(g.list,n=>(c(),j(u,{key:"item.id",value:n.id},{default:o(()=>[C(z(n.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),t(r,{label:"文章展图",name:"img",style:{width:"550px"}},{default:o(()=>[t(v,{value:e.img,"onUpdate:value":a[5]||(a[5]=n=>e.img=n)},null,8,["value"])]),_:1})]),_:1})]),_:1}),t(r,{name:"content"},{default:o(()=>[t(G,{value:e.content,"onUpdate:value":a[6]||(a[6]=n=>e.content=n),onGetContent:k},null,8,["value"])]),_:1}),t(r,{style:{"text-align":"right"}},{default:o(()=>[t(R,{"html-type":"submit",type:"primary"},{default:o(()=>[C("发表文章")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})],64)}}});const bt=V(K,[["__scopeId","data-v-dd2679f0"]]);export{bt as default};
