import{u as q}from"./vue-router-1948c3ab.js";import{g as M,a as H,p as ee}from"./request-303e577c.js";import{S as te}from"./axios-f944d4af.js";import{X as ae,ac as oe,O as ne,ad as B,e as T}from"./@ant-design-9faab50f.js";import{d as re,r as u,f as le,t as se,a0 as U,c as t,u as n,X as a,F as ie,_ as de,Y as s,Z as w,I as S,W as ue,a4 as D}from"./@vue-ed0e62b5.js";import{m as p}from"./ant-design-vue-8622cfc4.js";import"./axios-4a70c6fc.js";import"./@ctrl-fb5a5473.js";import"./@babel-9393a256.js";import"./resize-observer-polyfill-3d106987.js";import"./@emotion-c0b5c018.js";import"./stylis-af24efd6.js";import"./scroll-into-view-if-needed-6b992d05.js";import"./compute-scroll-into-view-183f845a.js";import"./vue-types-ef06c517.js";import"./dom-align-529d0cdc.js";import"./lodash-es-46efcfe4.js";import"./dayjs-bea8cda3.js";import"./async-validator-dee29e8b.js";import"./throttle-debounce-87e7e444.js";const me=(i,d)=>M({url:"api/v1/category",params:{page_size:d.value.pageSize,page_num:d.value.pageNum,name:d.value.name},...i}),pe=i=>M({url:"api/v1/category/"+i}),ce=(i,d)=>H({url:"api/v1/category/"+d,data:i}),fe=i=>ee({url:"api/v1/category/add",data:i}),y={categoryListApi:me,getCategoryApi:pe,editCategoryApi:ce,addCategoryApi:fe},ge=de("br",null,null,-1),_e={key:0},Me=re({__name:"CA_CategoryList",setup(i){const d=u(),V=q(),C=u([]),$=[{title:"CID",dataIndex:"id",key:"id",width:"15%"},{title:"分类名",dataIndex:"name",width:"15%",align:"center"},{title:"操作",dataIndex:"action",width:"30%",align:"center"}],A=u({pageSizeOptions:["10","50","100"],total:0,showSizeChanger:!0,hideOnSinglePage:!1,showQuickJumper:!1}),c=u({title:"",pageSize:10,pageNum:1}),f=()=>{y.categoryListApi(C,c).then(o=>{if(o.data.status!==200)return p.error("数据获取异常",10);C.value=o.data.data,A.value.total=o.data.total})};let l=le({id:"",name:""});const z={name:[{required:!0,message:"请输入分类名",trigger:"change"},{min:1,max:30,message:"Length should be 1 to 30",trigger:"blur"}]},g=u(!1),x=u(!1),F=o=>{g.value=!0},K=o=>{x.value=!0,y.addCategoryApi(l).then(e=>{e.data.status==200?p.success("成功添加分类！",5):p.warn(e.data.message,5),f()}).then(e=>{setTimeout(()=>{g.value=!1,x.value=!1},1e3)})},_=u(!1),h=u(!1),X=o=>{_.value=!0,y.getCategoryApi(o).then(e=>{l.id=e.data.data.id,l.name=e.data.data.name})},G=o=>{h.value=!0,y.editCategoryApi(l,o).then(e=>{e.data.status==200?p.success("成功修改分类信息！",5):p.warn(e.data.message,5),f()}).then(e=>{setTimeout(()=>{_.value=!1,h.value=!1},1e3)})},J=async o=>{let e;return e=await te.delete("api/v1/category/"+o),e.data.status!==200?p.error("删除数据异常！",10):new Promise(v=>{setTimeout(()=>v(!0),3e3)}).then(()=>{f(),p.success("成功删除分类！",5)})},P=(o,e,v)=>{const m={...o};m.current=o.current,m.pageSize=o.pageSize,c.value.pageSize=o.pageSize,c.value.pageNum=o.current,m.pageSize!==o.pageSize&&(c.value.pageNum=1,m.current=1),o=m,f()};return f(),se(l),(o,e)=>{const v=s("a-page-header"),m=s("a-input-search"),I=s("a-col"),k=s("a-button"),Q=s("a-row"),W=s("a-popconfirm"),Y=s("a-space"),Z=s("a-table"),O=s("a-tooltip"),N=s("a-input"),L=s("a-form-item"),E=s("a-form"),R=s("a-modal");return w(),U(ie,null,[t(v,{style:{border:"1px solid rgb(235, 237, 240)"},title:"分类列表",onBack:e[0]||(e[0]=()=>n(V).push("Index"))}),ge,t(Q,null,{default:a(()=>[t(I,{lg:6,md:6,sm:16,xl:6,xs:16},{default:a(()=>[t(m,{value:c.value.name,"onUpdate:value":e[1]||(e[1]=r=>c.value.name=r),allowClear:"","enter-button":"",placeholder:"输入分类名搜索分类信息",onSearch:f},null,8,["value"])]),_:1}),t(I,{lg:6,md:6,sm:6,xl:6,xs:6},{default:a(()=>[t(k,{style:{"margin-left":"10px"},type:"primary",onClick:F},{icon:a(()=>[t(n(ae))]),default:a(()=>[S(" 添加分类 ")]),_:1})]),_:1})]),_:1}),t(Z,{bordered:!0,columns:$,"data-source":C.value,pagination:A.value,"row-key":r=>r.id,style:{margin:"15px"},onChange:P},{bodyCell:a(({column:r,text:ve,record:b})=>[r.dataIndex==="action"?(w(),ue(Y,{key:0,size:8},{default:a(()=>[t(k,{type:"primary",onClick:j=>X(b.id)},{icon:a(()=>[t(n(oe))]),default:a(()=>[S(" 编辑 ")]),_:2},1032,["onClick"]),b.ID!=1?(w(),U("div",_e,[t(W,{title:"是否删除这篇文章",onConfirm:j=>J(b.id)},{default:a(()=>[t(k,{danger:"",type:"primary"},{icon:a(()=>[t(n(ne))]),default:a(()=>[S(" 删除 ")]),_:1})]),_:2},1032,["onConfirm"])])):D("",!0)]),_:2},1024)):D("",!0)]),_:1},8,["data-source","pagination","row-key"]),t(R,{open:g.value,"onUpdate:open":e[3]||(e[3]=r=>g.value=r),"confirm-loading":x.value,title:"添加分类",onOk:e[4]||(e[4]=r=>K(n(l).id))},{default:a(()=>[t(E,{ref_key:"formRef",ref:d,model:n(l),rules:z},{default:a(()=>[t(L,{name:"name"},{default:a(()=>[t(N,{value:n(l).name,"onUpdate:value":e[2]||(e[2]=r=>n(l).name=r),placeholder:"分类名"},{prefix:a(()=>[t(n(B))]),suffix:a(()=>[t(O,{title:"输入分类名"},{default:a(()=>[t(n(T),{style:{color:"rgba(0, 0, 0, 0.45)"}})]),_:1})]),_:1},8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["open","confirm-loading"]),t(R,{open:_.value,"onUpdate:open":e[6]||(e[6]=r=>_.value=r),"confirm-loading":h.value,title:"编辑分类信息",onOk:e[7]||(e[7]=r=>G(n(l).id))},{default:a(()=>[t(E,{ref_key:"formRef",ref:d,model:n(l),rules:z},{default:a(()=>[t(L,{name:"name"},{default:a(()=>[t(N,{value:n(l).name,"onUpdate:value":e[5]||(e[5]=r=>n(l).name=r),placeholder:"分类名"},{prefix:a(()=>[t(n(B))]),suffix:a(()=>[t(O,{title:"输入分类名"},{default:a(()=>[t(n(T),{style:{color:"rgba(0, 0, 0, 0.45)"}})]),_:1})]),_:1},8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["open","confirm-loading"])],64)}}});export{Me as default};
