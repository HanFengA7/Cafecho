import{r as N}from"./index-b996fa11.js";import{S as y}from"./axios-602dd91c.js";import{a as T}from"./articlelist-ae9be7fd.js";import{_ as V}from"./index.vue_vue_type_script_setup_true_lang-b3a75293.js";import{d as E,r as x,f as h,t as G,a0 as w,c as t,u as W,X as o,F as b,_ as $,Y as r,Z as u,a1 as L,I as k,W as O,$ as X}from"./@vue-f4549c4f.js";import{n as c}from"./ant-design-vue-bdf622a3.js";import"./pinia-6e7a6e83.js";import"./vue-router-7a2dbc5b.js";import"./@ant-design-79c5b16b.js";import"./@ctrl-fb5a5473.js";import"./@babel-9393a256.js";import"./resize-observer-polyfill-3d106987.js";import"./@emotion-c0b5c018.js";import"./stylis-af24efd6.js";import"./scroll-into-view-if-needed-6b992d05.js";import"./compute-scroll-into-view-183f845a.js";import"./vue-types-ef06c517.js";import"./dom-align-529d0cdc.js";import"./lodash-es-46efcfe4.js";import"./dayjs-bea8cda3.js";import"./async-validator-dee29e8b.js";import"./throttle-debounce-87e7e444.js";import"./axios-4a70c6fc.js";import"./request-d135d996.js";import"./@tinymce-00f36401.js";import"./tinymce-6ac3427d.js";const Y=$("br",null,null,-1),yt=E({__name:"CA_ArticleAdd",setup(Z){let m;y.get("api/v1/AuthTokenInfo/"+window.sessionStorage.getItem("token")).then(l=>{m=l.data.UserInfo[0].ID});const _=x(),e=h({uid:m,title:"",desc:"",tags:void 0,cid:1,img:"",content:""}),d=x([]),f=h({list:[{id:null,name:"不使用分类"}]}),A=()=>{y.get("api/v1/category",{params:{page_num:1}}).then(l=>{if(l.data.total!=0){let a=[];for(let i=0;i<l.data.total;i++)a.push({id:l.data.data[i].id,name:l.data.data[i].name});f.list=a}})},C={title:[{required:!0,message:"请输入文章标题",trigger:"change"}],desc:[{required:!0,message:"请输入文章概要",trigger:"change"}],content:[{required:!0,message:"请输入文章内容",trigger:"change"}]},F=l=>{e.content=l},S=()=>{e.uid=m,e.tags=d.value.toString(),T.articleAddApi(e).then(l=>{l.data.status!=200?c.error({message:"Error",description:l.data.message}):(c.success({message:"Success",description:"文章发表成功"}),_.value.resetFields())})},U=()=>{c.warn({message:"Warn",description:"请勿提交非法数据！"}),console.log(e.content)};return A(),G(e),(l,a)=>{const i=r("a-page-header"),g=r("a-input"),s=r("a-form-item"),I=r("a-textarea"),v=r("a-col"),p=r("a-select"),B=r("a-row"),D=r("a-button"),R=r("a-form"),q=r("a-card");return u(),w(b,null,[t(i,{style:{border:"1px solid rgb(235, 237, 240)"},title:"撰写文章",onBack:a[0]||(a[0]=()=>W(N).push("Index"))}),Y,t(q,null,{default:o(()=>[t(R,{ref_key:"formRef",ref:_,model:e,rules:C,name:"ArticleAddForm",onFinish:S,onFinishFailed:U},{default:o(()=>[t(B,null,{default:o(()=>[t(v,{span:12},{default:o(()=>[t(s,{label:"文章标题",name:"title",style:{width:"550px"}},{default:o(()=>[t(g,{value:e.title,"onUpdate:value":a[1]||(a[1]=n=>e.title=n)},null,8,["value"])]),_:1}),t(s,{label:"文章概要",name:"desc",style:{width:"550px"}},{default:o(()=>[t(I,{value:e.desc,"onUpdate:value":a[2]||(a[2]=n=>e.desc=n),style:{height:"85px"}},null,8,["value"])]),_:1})]),_:1}),t(v,{span:12},{default:o(()=>[t(s,{label:"文章标签",name:"tags",style:{width:"550px"}},{default:o(()=>[t(p,{value:d.value,"onUpdate:value":a[3]||(a[3]=n=>d.value=n),"token-separators":[","],mode:"tags",placeholder:"填写一些文章的标签",style:{width:"100%"}},null,8,["value"])]),_:1}),t(s,{label:"文章分类",name:"cid",style:{width:"550px"}},{default:o(()=>[t(p,{value:e.cid,"onUpdate:value":a[4]||(a[4]=n=>e.cid=n),name:"cid",placeholder:"文章分类"},{default:o(()=>[(u(!0),w(b,null,L(f.list,n=>(u(),O(p,{key:"item.id",value:n.id},{default:o(()=>[k(X(n.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),t(s,{label:"文章展图",name:"img",style:{width:"550px"}},{default:o(()=>[t(g,{value:e.img,"onUpdate:value":a[5]||(a[5]=n=>e.img=n)},null,8,["value"])]),_:1})]),_:1})]),_:1}),t(s,{name:"content"},{default:o(()=>[t(V,{value:e.content,"onUpdate:value":a[6]||(a[6]=n=>e.content=n),onGetContent:F},null,8,["value"])]),_:1}),t(s,{style:{"text-align":"right"}},{default:o(()=>[t(D,{"html-type":"submit",type:"primary"},{default:o(()=>[k("发表文章")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})],64)}}});export{yt as default};
